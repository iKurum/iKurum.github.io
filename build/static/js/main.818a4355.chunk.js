(this.webpackJsonpsakura=this.webpackJsonpsakura||[]).push([[0],{11:function(e,t,n){e.exports={trTh:"Folder_trTh__3ZRPu",tableA:"Folder_tableA__3CAtA"}},12:function(e,t,n){e.exports={datainfo:"OneDrive_datainfo__32r2b",infobox:"OneDrive_infobox__2fgVs",nav:"OneDrive_nav__d1qUw"}},19:function(e,t,n){e.exports={app:"App_app__3J6LF"}},20:function(e,t,n){e.exports=n(33)},27:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(17),r=n.n(c),l=(n(27),n(7));var i=function(){var e=this,t=new Headers;this.graph="https://graph.microsoft.com/v1.0",this.init=function(n){var a="Bearer "+n;t.append("Authorization",a),e.opt={method:"GET",headers:t},e.token=n},this.url=function(t,n){switch(n){case"json":return e.token?fetch("".concat(e.graph).concat(t),e.opt).then((function(e){return e.ok?e.json():Promise.reject({ST:"\u83b7\u53d6\u5185\u5bb9\u9519\u8bef ...",status:e.status,statusText:e.statusText})})):Promise.resolve({});case"arrayBuffer":return e.token?fetch("".concat(e.graph).concat(t),e.opt).then((function(e){return e.ok?e.arrayBuffer():Promise.resolve({ST:"\u83b7\u53d6\u5185\u5bb9\u9519\u8bef ...",status:e.status,statusText:e.statusText})})):Promise.resolve({});default:Promise.resolve({})}}},s=n(6),u=n(1);var m=function(){return o.a.createElement(o.a.Fragment,null,"Home",o.a.createElement("div",{style:{height:"100%"}},"Home"))};var f=function(){return o.a.createElement(o.a.Fragment,null,"Profile")};var p=function(){return o.a.createElement(o.a.Fragment,null,"OutLook")},h=Object(a.createContext)(null);function g(e){if(isNaN(e))return"";var t=Math.floor(Math.log(e)/Math.log(2));t<1&&(t=0);var n=Math.floor(t/10);return(e/=Math.pow(2,10*n)).toString().length>e.toFixed(2).toString().length&&(e=e.toFixed(2)),e+" "+["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]}function E(e){if(e.folder)return"iconfont icon-open_filled";if(e.package&&"oneNote"===e.package.type)return"iconfont icon-microsoftonenote";if(!e.file)return"iconfont icon-geshi_weizhi";switch(e.name.split(".")[e.name.split(".").length-1].toLowerCase()){case"pdf":return"iconfont icon-pdf";case"doc":case"docx":return"iconfont icon-Word";case"ppt":case"pptx":return"iconfont icon-office-pptx";case"xls":case"xlsx":return"iconfont icon-office-excel";case"mp4":case"flv":case"mkv":return"iconfont icon-video";case"mp3":return"iconfont icon-MusicAcc";case"jpeg":case"jpg":case"png":return"iconfont icon-image";case"7z":case"zip":case"gz":case"rar":return"iconfont icon-filezip";case"md":return"iconfont icon-file-markdown";case"exe":return"iconfont icon-exe";case"iso":return"iconfont icon-iso";case"txt":return"iconfont icon-txt";case"apk":return"iconfont icon-apk";default:return"iconfont icon-geshi_weizhi"}}var d=n(11),v=n.n(d);var b=function(e){var t=Object(u.g)().pathname;return o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",{className:v.a.trTh},o.a.createElement("th",null,"\u540d\u79f0"),o.a.createElement("th",null,"\u5927\u5c0f"),o.a.createElement("th",null,"\u6700\u540e\u4fee\u6539\u65f6\u95f4"))),o.a.createElement("tbody",null,o.a.createElement(o.a.Fragment,null,e.value.map((function(e,n){return o.a.createElement("tr",{key:n},o.a.createElement("td",null,e.folder?o.a.createElement(s.b,{to:"".concat(t,"/").concat(e.name)},o.a.createElement("p",{className:v.a.tableA},o.a.createElement("i",{className:E(e),style:{marginRight:"10px"}}),e.name)):o.a.createElement("p",{className:v.a.tableA},o.a.createElement("i",{className:E(e),style:{marginRight:"10px"}}),e.name)),o.a.createElement("td",null,g(e.size)),o.a.createElement("td",null,e.lastModifiedDateTime.slice(0,10)),e.folder?null:o.a.createElement("td",null,o.a.createElement("i",{className:"iconfont icon-xiazai"})))})))))},k=n(12),j=n.n(k);var x=function(){var e=Object(a.useContext)(h),t=e.micro,n=e.change,c=Object(a.useState)({}),r=Object(l.a)(c,2),i=r[0],s=r[1],m=Object(a.useState)([]),f=Object(l.a)(m,2),p=f[0],E=f[1],d=Object(u.g)().pathname,v=Object(u.f)();function k(e){return function(){var t="/"+d.split("/").slice(1,d.split("/").length).slice(0,e).join("/");v.push(t)}}return Object(a.useEffect)((function(){t.url&&(t.url("/me/drive/root".concat(d.substring(9)?":".concat(d.substring(9)):""),"json").then((function(e){n(s,e)})).catch((function(e){alert(e)})),t.url("/me/drive/root".concat(d.substring(9)?":".concat(d.substring(9),":"):"","/children"),"json").then((function(e){n(E,e.value)})).catch((function(e){alert(e)})))}),[t,n,d]),o.a.createElement(o.a.Fragment,null,o.a.createElement("p",{className:j.a.nav},d.split("/").map((function(e,t){return t?o.a.createElement("span",{key:t,onClick:k(t)},"onedrive"===e?"/":e):null}))),i.fileSystemInfo?o.a.createElement("div",{className:j.a.infobox},o.a.createElement("p",{className:j.a.datainfo},o.a.createElement("span",null,"\u521b\u5efa\u65f6\u95f4\uff1a",i.fileSystemInfo.createdDateTime.slice(0,10)),o.a.createElement("span",null,"\u4e0a\u6b21\u4fee\u6539\u65f6\u95f4\uff1a",i.fileSystemInfo.lastModifiedDateTime.slice(0,10)),o.a.createElement("span",null,"\u5df2\u4f7f\u7528\u7a7a\u95f4\uff1a",g(i.size))),o.a.createElement("hr",null)):o.a.createElement(o.a.Fragment,null,"\u52a0\u8f7d\u4e2d ..."),p.length>0?o.a.createElement(b,{value:p}):o.a.createElement(o.a.Fragment,null,"\u52a0\u8f7d\u4e2d ..."))};var O=function(){var e=Object(u.h)().path;return o.a.createElement(u.c,null,o.a.createElement(u.a,{exact:!0,path:e},o.a.createElement(x,null)),o.a.createElement(u.a,{path:"".concat(e,"/:folder")},o.a.createElement(x,null)))},_=n(9),T=n.n(_);var N=function(){var e=Object(a.useState)({}),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),i=Object(l.a)(r,2),g=i[0],E=i[1],d=Object(a.useContext)(h),v=d.micro,b=d.change,k=Object(a.useRef)(null);return Object(a.useEffect)((function(){v.url&&(v.url("/me?$select=givenName","json").then((function(e){b(c,e)})).catch((function(e){alert(e)})),v.url("/me/photo/$value","arrayBuffer").then((function(e){b(E,function(e){for(var t="",n=new Uint8Array(e),a=n.byteLength,o=0;o<a;o++)t+=String.fromCharCode(n[o]);return window.btoa(t)}(e))})).catch((function(e){alert(e)})))}),[v,b]),o.a.createElement(o.a.Fragment,null,n.givenName?o.a.createElement(s.a,null,o.a.createElement("header",null,o.a.createElement(s.b,{to:"/"},o.a.createElement("img",{src:"data:image/png;base64,".concat(g),ref:k,className:T.a.userPhoto,alt:"user"})),o.a.createElement(s.b,{to:"/profile"},o.a.createElement("p",{className:T.a.userName},n.givenName)),o.a.createElement("ul",null,o.a.createElement(s.b,{to:"/onedrive"},o.a.createElement("li",{className:T.a.nav},o.a.createElement("i",{className:"iconfont icon-jifangguanli"},"OneDrive"))),o.a.createElement(s.b,{to:"/outlook"},o.a.createElement("li",{className:T.a.nav},o.a.createElement("i",{className:"iconfont icon-185078emailmailstreamline"},"OutLook"))))),o.a.createElement("div",{className:T.a.page},o.a.createElement(u.c,null,o.a.createElement(u.a,{exact:!0,path:"/",component:m}),o.a.createElement(u.a,{path:"/profile",component:f}),o.a.createElement(u.a,{path:"/onedrive",component:O}),o.a.createElement(u.a,{path:"/outlook",component:p})))):o.a.createElement(o.a.Fragment,null,"\u52a0\u8f7d\u4e2d ..."))},w=new(n(35).a)({auth:{clientId:"2c16b16f-0bb3-41ed-a423-3ae5dfae9b63",redirectUri:"http://localhost:3000/",storeAuthStateInCookie:!0}}),S={scopes:["user.read"]};function y(){return console.log("login ..."),w.getAccount()||(console.log("\u521d\u59cb\u5316 ..."),sessionStorage.clear(),w.loginPopup().catch((function(e){alert(e)}))),F()}function F(){if(console.log("Token:"),w.getAccount())return console.log("\u5c1d\u8bd5\u83b7\u53d6 Token 1 ..."),w.acquireTokenSilent(S).then((function(e){return console.log("\u5c1d\u8bd5\u83b7\u53d6 Token 1 ...ok"),e.accessToken})).catch((function(e){if(console.log("\u5c1d\u8bd5\u83b7\u53d6 Token 2 ..."),"InteractionRequiredAuthError"===e.name)return w.acquireTokenPopup(S).then((function(e){return console.log("\u5c1d\u8bd5\u83b7\u53d6 Token 2 ...ok"),e.accessToken})).catch((function(e){console.log("\u83b7\u53d6\u5931\u8d25 Token ..."),console.log(e)}))}));console.log("\u5c1d\u8bd5\u5237\u65b0 ..."),console.log("reload ... 1s");var e=null;return clearTimeout(e),e=setTimeout((function(){console.log("reload ..."),window.location.reload()}),1e3),new Promise((function(){return""}),(function(){return""}))}var P=n(19),A=n.n(P);var B=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(""),s=Object(l.a)(r,2),u=s[0],m=s[1],f=Object(a.useCallback)((function(e,t){e(t)}),[]),p=Object(a.useCallback)((function(){y().then((function(e){console.log("\u5199\u5165 Token ..."),f(c,e)})).catch((function(e){console.log(e)}))}),[f]);return Object(a.useEffect)((function(){sessionStorage.getItem("msal.idtoken")?p():y().then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}),[p]),Object(a.useEffect)((function(){var e=new i;n&&e.init(n),f(m,e)}),[f,n]),o.a.createElement(h.Provider,{value:{micro:u,change:f}},o.a.createElement("div",{className:A.a.app},o.a.createElement(N,null)))};r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(B,null)),document.getElementById("root"))},9:function(e,t,n){e.exports={page:"Head_page__kWlT5",userPhoto:"Head_userPhoto__3cBOH",userName:"Head_userName__UpgrF",nav:"Head_nav__RgzWw"}}},[[20,1,2]]]);
//# sourceMappingURL=main.818a4355.chunk.js.map