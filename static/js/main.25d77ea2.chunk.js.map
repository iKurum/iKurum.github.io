{"version":3,"sources":["assets/css/App.module.css","pages/Home.js","pages/Profile.js","pages/OutLook.js","pages/Article.js","hooks/Loading.js","utils/Func.js","utils/GetInfo.js","hooks/Iframe.js","utils/Context.js","hooks/Folder.js","pages/OneDrive.js","hooks/OneDriveNesting.js","config.js","hooks/App.js","index.js","assets/css/Iframe.module.css","assets/css/Folder.module.css","assets/css/Loading.module.css","assets/css/OneDrive.module.css","setupProxy.js"],"names":["module","exports","Home","Profile","OutLook","Article","Loading","React","forwardRef","_","cRef","useState","isLoad","setIsLoad","useImperativeHandle","isOk","isNotOk","className","css","wall","style","display","loading","FolderIcon","data","folder","package","type","file","name","split","length","toLowerCase","require","GetInfo","url","c","access_token","v","headers","Authorization","fetch","then","res","ok","json","Promise","reject","status","statusText","method","arrayBuffer","resolve","str","Iframe","props","ifrRef","useRef","childRef","useEffect","current","attachEvent","onload","ref","ifrBox","onClick","title","src","iframe","seamless","tokenContext","createContext","Folder","ifrSrc","setIfrSrc","pathname","useLocation","useContext","change","token","trTh","value","map","i","key","to","tableA","marginRight","id","getUrl","catch","err","console","log","bytes","isNaN","exp","Math","floor","pow","toString","toFixed","ByteConvert","size","lastModifiedDateTime","slice","downURL","window","location","href","OneDrive","folderData","setFolderData","history","useHistory","goto","a","join","push","substring","d","nav","Nesting","path","useRouteMatch","exact","baseConfig","client_id","client_secret","loginURL","redirect_uri","scope","Head","setData","setToken","photo","setPhoto","login","setLogin","useCallback","set","searchURL","search","s","target","t","SearchURL","state","code","body","JSON","stringify","buffer","binary","Uint8Array","len","byteLength","String","fromCharCode","btoa","ArrayBufferToBase64","Provider","App","givenName","userPhoto","alt","userName","page","component","OneDriveNesting","ReactDOM","render","StrictMode","document","getElementById","createProxyMiddleware","app","use","pathRewrite","changeOrigin"],"mappings":"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","file":"static/js/main.25d77ea2.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"App\":\"App_App__obQeD\",\"page\":\"App_page__3E-jT\",\"userPhoto\":\"App_userPhoto__1Py3h\",\"userName\":\"App_userName__2-qV-\",\"nav\":\"App_nav__27ePW\",\"logout\":\"App_logout__3CR6Y\"};","import React from 'react';\r\n\r\nfunction Home() {\r\n  return (\r\n    <>\r\n      Home\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Home;","import React from 'react';\r\n\r\nfunction Profile() {\r\n  return (\r\n    <>\r\n      Profile\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Profile;","import React from 'react';\r\n\r\nfunction OutLook() {\r\n  return (\r\n    <>\r\n      OutLook\r\n    </>\r\n  );\r\n}\r\n\r\nexport default OutLook;","import React from 'react';\r\n\r\nfunction Article() {\r\n  return (\r\n    <>\r\n      Article\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Article;","import React, { useState, useImperativeHandle } from 'react';\r\nimport css from '../assets/css/Loading.module.css';\r\n\r\nconst Loading = React.forwardRef((_, cRef) => {\r\n  const [isLoad, setIsLoad] = useState(true);\r\n\r\n  useImperativeHandle(cRef, () => ({\r\n    isOk: () => {\r\n      setIsLoad(false);\r\n    },\r\n    isNotOk: () => {\r\n      setIsLoad(true);\r\n    }\r\n  }))\r\n\r\n  return (\r\n    <div className={css.wall} style={{display: isLoad ? 'block' : 'none'}}>\r\n      <div className={css.loading}>\r\n        LOADING ...\r\n      </div>\r\n    </div>\r\n  );\r\n})\r\n\r\nexport default Loading;","function ByteConvert(bytes) {\r\n  if (isNaN(bytes)) {\r\n    return '';\r\n  }\r\n  const symbols = ['bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\n\r\n  let exp = Math.floor(Math.log(bytes) / Math.log(2));\r\n  if (exp < 1) {\r\n    exp = 0;\r\n  }\r\n\r\n  const i = Math.floor(exp / 10);\r\n  bytes = bytes / Math.pow(2, 10 * i);\r\n\r\n  if (bytes.toString().length > bytes.toFixed(2).toString().length) {\r\n    bytes = bytes.toFixed(2);\r\n  }\r\n\r\n  return bytes + ' ' + symbols[i];\r\n};\r\n\r\nfunction ArrayBufferToBase64(buffer) {\r\n  var binary = '';\r\n  var bytes = new Uint8Array(buffer);\r\n  var len = bytes.byteLength;\r\n  for (var i = 0; i < len; i++) {\r\n    binary += String.fromCharCode(bytes[i]);\r\n  }\r\n  return window.btoa(binary);\r\n}\r\n\r\nfunction FolderIcon(data) {\r\n  if (data.folder) {\r\n    return 'iconfont icon-open_filled';\r\n  } else if (data.package && data.package.type === 'oneNote') {\r\n    return 'iconfont icon-microsoftonenote';\r\n  } else if (data.file) {\r\n    switch (data.name.split('.')[data.name.split('.').length - 1].toLowerCase()) {\r\n      case 'pdf':\r\n        return 'iconfont icon-pdf';\r\n      case 'doc':\r\n      case 'docx':\r\n        return 'iconfont icon-Word';\r\n      case 'ppt':\r\n      case 'pptx':\r\n        return 'iconfont icon-office-pptx';\r\n      case 'xls':\r\n      case 'xlsx':\r\n        return 'iconfont icon-office-excel';\r\n      case 'mp4':\r\n      case 'flv':\r\n      case 'mkv':\r\n        return 'iconfont icon-video';\r\n      case 'mp3':\r\n        return 'iconfont icon-MusicAcc';\r\n      case 'jpeg':\r\n      case 'jpg':\r\n      case 'png':\r\n        return 'iconfont icon-image';\r\n      case '7z':\r\n      case 'zip':\r\n      case 'gz':\r\n      case 'rar':\r\n        return 'iconfont icon-filezip';\r\n      case 'md':\r\n        return 'iconfont icon-file-markdown';\r\n      case 'exe':\r\n        return 'iconfont icon-exe';\r\n      case 'iso':\r\n        return 'iconfont icon-iso';\r\n      case 'txt':\r\n        return 'iconfont icon-txt';\r\n      case 'apk':\r\n        return 'iconfont icon-apk';\r\n      default:\r\n        return 'iconfont icon-geshi_weizhi';\r\n    }\r\n  } else {\r\n    return 'iconfont icon-geshi_weizhi';\r\n  }\r\n}\r\n\r\nfunction SearchURL(search) {\r\n  let s = {};\r\n  const searchURL = search.substring(1, search.length);\r\n  const target = searchURL.split('&');\r\n  for (let i = 0; i < target.length; i++) {\r\n    const t = target[i].split('=');\r\n    s[t[0]] = t[1];\r\n  };\r\n  return s;\r\n}\r\n\r\nexport { ByteConvert, ArrayBufferToBase64, FolderIcon, SearchURL };","require('../setupProxy');\r\n\r\nfunction GetInfo(url, c, access_token, v = null) {\r\n  if (typeof access_token === 'string') {\r\n    const headers = {\r\n      Authorization: `Bearer ${access_token}`\r\n    }\r\n\r\n    switch (c) {\r\n      case 'json':\r\n        switch (v) {\r\n          case 'onedrive':\r\n            return fetch(\r\n              `/ms/drive/root:/emilia - share${url}`,\r\n              { headers: headers })\r\n              .then(res => {\r\n                if (res.ok) {\r\n                  return res.json();\r\n                } else {\r\n                  return Promise.reject({\r\n                    status: res.status,\r\n                    statusText: res.statusText\r\n                  })\r\n                };\r\n              })\r\n          case 'preview':\r\n            return fetch(\r\n              `/ms/drive/items/${url}/preview`,\r\n              {\r\n                method: 'POST',\r\n                headers: headers\r\n              })\r\n              .then(res => {\r\n                if (res.ok) {\r\n                  return res.json();\r\n                } else {\r\n                  return Promise.reject({\r\n                    status: res.status,\r\n                    statusText: res.statusText\r\n                  })\r\n                };\r\n              })\r\n          default:\r\n            return fetch(\r\n              `/ms${url}?$select=givenName`,\r\n              { headers: headers })\r\n              .then(res => {\r\n                if (res.ok) {\r\n                  return res.json();\r\n                } else {\r\n                  return Promise.reject({\r\n                    status: res.status,\r\n                    statusText: res.statusText\r\n                  })\r\n                };\r\n              })\r\n        }\r\n      case 'arrayBuffer':\r\n        return fetch(\r\n          `/ms${url}`,\r\n          { headers: headers })\r\n          .then(res => {\r\n            if (res.ok) {\r\n              return res.arrayBuffer();\r\n            } else {\r\n              return Promise.resolve({\r\n                status: res.status,\r\n                statusText: res.statusText\r\n              })\r\n            };\r\n          })\r\n      default:\r\n        return Promise.resolve({ str: '格式不匹配' });\r\n    }\r\n  }\r\n  return Promise.resolve({ str: '等待 access_token' });\r\n}\r\n\r\nexport default GetInfo;","import React, { useRef, useEffect, useState, useImperativeHandle } from 'react';\r\nimport Loading from './Loading';\r\nimport css from '../assets/css/Iframe.module.css';\r\n\r\nconst Iframe = React.forwardRef((props, cRef) => {\r\n  const [isLoad, setIsLoad] = useState(false);\r\n  const ifrRef = useRef();\r\n  const childRef = useRef();\r\n\r\n  useImperativeHandle(cRef, () => ({\r\n    isOk: () => {\r\n      setIsLoad(false);\r\n    },\r\n    isNotOk: () => {\r\n      setIsLoad(true);\r\n    }\r\n  }))\r\n\r\n  useEffect(() => {\r\n    if (isLoad) {\r\n      if (ifrRef.current.attachEvent) {\r\n        // IE\r\n        ifrRef.current.attachEvent('onload', () => {\r\n          childRef.current.isOk();\r\n        })\r\n      } else {\r\n        // 非IE\r\n        ifrRef.current.onload = () => {\r\n          childRef.current.isOk();\r\n        }\r\n      }\r\n    }\r\n  })\r\n\r\n  return (\r\n    <div className={css.wall} style={{ display: isLoad ? 'block' : 'none' }}>\r\n      <Loading ref={childRef} cRef={childRef} />\r\n      <div className={css.ifrBox}>\r\n        <i className='iconfont icon-guanbi' onClick={() => {\r\n          setIsLoad(false);\r\n        }}></i>\r\n        <iframe\r\n          title='preview'\r\n          src={isLoad ? props.src : null}\r\n          className={css.iframe}\r\n          ref={ifrRef}\r\n          seamless\r\n        >\r\n          您当前浏览器不支持 iframe\r\n        </iframe>\r\n      </div>\r\n    </div>\r\n  );\r\n})\r\n\r\nexport default Iframe;\r\n","import { createContext } from 'react';\r\n\r\nconst tokenContext = createContext(null);\r\n\r\n\r\nexport default tokenContext;","import React, { useState, useContext, useRef } from 'react';\r\nimport { NavLink, useLocation } from 'react-router-dom';\r\nimport { ByteConvert, FolderIcon } from '../utils/Func';\r\nimport GetInfo from '../utils/GetInfo';\r\nimport Iframe from '../hooks/Iframe';\r\nimport tokenContext from '../utils/Context';\r\nimport css from '../assets/css/Folder.module.css';\r\n\r\nfunction Folder(props) {\r\n  const [ifrSrc, setIfrSrc] = useState('');\r\n  const { pathname } = useLocation();\r\n  const { change, token } = useContext(tokenContext);\r\n  const childRef = useRef();\r\n\r\n  const getPreview = id => {\r\n    props.loading.current.isNotOk();\r\n    GetInfo(id, 'json', token, 'preview')\r\n      .then(data => {\r\n        change(setIfrSrc, data.getUrl);\r\n      })\r\n      .then(() => {\r\n        props.loading.current.isOk();\r\n        childRef.current.isNotOk();\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n        props.loading.current.isOk();\r\n      })\r\n  };\r\n\r\n  const getContent = downURL => {\r\n    window.location.href = downURL;\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <table>\r\n        <thead>\r\n          <tr className={css.trTh}>\r\n            <th>名称</th>\r\n            <th>大小</th>\r\n            <th>最后修改时间</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {\r\n            props.value.map((v, i) => {\r\n              return (\r\n                <tr key={i}>\r\n                  <td>\r\n                    {\r\n                      v.folder\r\n                        ?\r\n                        <NavLink\r\n                          to={`${pathname}/${v.name}`}\r\n                          onClick={() => {\r\n                            props.loading.current.isNotOk();\r\n                          }}\r\n                        >\r\n                          <p className={css.tableA}>\r\n                            <i\r\n                              className={FolderIcon(v)}\r\n                              style={{ marginRight: '10px' }}\r\n                            >\r\n                            </i>\r\n                            {v.name}\r\n                          </p>\r\n                        </NavLink>\r\n                        :\r\n                        <p className={css.tableA} onClick={() => {\r\n                          getPreview(v.id);\r\n                        }}>\r\n                          <i\r\n                            className={FolderIcon(v)}\r\n                            style={{ marginRight: '10px' }}\r\n                          >\r\n                          </i>\r\n                          {v.name}\r\n                        </p>\r\n                    }\r\n                  </td>\r\n                  <td>{ByteConvert(v.size)}</td>\r\n                  <td>{v.lastModifiedDateTime.slice(0, 10)}</td>\r\n                  {\r\n                    v.folder ? null :\r\n                      <td>\r\n                        <i className='iconfont icon-xiazai' onClick={() => {\r\n                          getContent(v['@microsoft.graph.downloadUrl']);\r\n                        }}></i>\r\n                      </td>\r\n                  }\r\n                </tr>\r\n              );\r\n            })\r\n          }\r\n        </tbody>\r\n      </table>\r\n      <Iframe src={ifrSrc} ref={childRef} cRef={childRef} />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Folder;","import React, { useEffect, useState, useRef, useContext } from 'react';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\nimport Loading from '../hooks/Loading';\r\nimport Folder from '../hooks/Folder';\r\nimport GetInfo from '../utils/GetInfo';\r\nimport tokenContext from '../utils/Context';\r\nimport css from '../assets/css/OneDrive.module.css';\r\n\r\nfunction OneDrive() {\r\n  const [folderData, setFolderData] = useState([]);\r\n  const { pathname } = useLocation();\r\n  const history = useHistory();\r\n  const childRef = useRef();\r\n  const { change, token } = useContext(tokenContext);\r\n\r\n  // 导航跳转\r\n  function goto(i) {\r\n    return () => {\r\n      const a = '/' + pathname.split('/').slice(1, pathname.split('/').length).slice(0, i).join('/');\r\n      history.push(a);\r\n    };\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (token) {\r\n      childRef.current.isNotOk();\r\n      GetInfo(`${!!pathname.substring(9) ? `${pathname.substring(9)}:` : ':'}/children`, 'json', token, 'onedrive')\r\n        .then(d => {\r\n          change(setFolderData, d.value);\r\n        })\r\n        .then(() => {\r\n          childRef.current.isOk();\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    }\r\n  }, [change, pathname, token])\r\n\r\n  return (\r\n    <>\r\n      <p className={css.nav}>\r\n        {\r\n          pathname.split('/').map((v, i) => {\r\n            if (i) {\r\n              return <span key={i} onClick={goto(i)}>{v === 'onedrive' ? '/' : v}</span>\r\n            }\r\n            return null;\r\n          })\r\n        }\r\n      </p>\r\n      <Folder\r\n        value={folderData}\r\n        loading={childRef}\r\n      />\r\n      <Loading ref={childRef} cRef={childRef} />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default OneDrive;","import React from 'react';\r\nimport { Switch, Route, useRouteMatch } from 'react-router-dom';\r\nimport OneDrive from '../pages/OneDrive';\r\n\r\nfunction Nesting() {\r\n  const { path } = useRouteMatch();\r\n\r\n  return (\r\n    <Switch>\r\n      <Route exact path={path}>\r\n        <OneDrive />\r\n      </Route>\r\n      <Route path={`${path}/:folder`}>\r\n        <OneDrive />\r\n      </Route>\r\n    </Switch>\r\n  );\r\n}\r\n\r\nexport default Nesting;","export const baseConfig = {\r\n  client_id: '2c16b16f-0bb3-41ed-a423-3ae5dfae9b63',\r\n  client_secret: 'Hlg~Z1~4ymZg-8oAm5ohcTM~_AJwctJnRU',\r\n  loginURL: 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize',\r\n  redirect_uri: process.env.NODE_ENV === 'development'\r\n    ?\r\n    'http://localhost:3000'\r\n    :\r\n    'https://ikurum.github.io',\r\n  scope: 'offline_access user.read mail.read files.read'\r\n};\r\n","import React, { useState, useCallback, useEffect } from 'react';\r\nimport { BrowserRouter, Route, NavLink, Switch } from 'react-router-dom';\r\n\r\nimport Home from '../pages/Home';\r\nimport Profile from '../pages/Profile';\r\nimport OutLook from '../pages/OutLook';\r\nimport Article from '../pages/Article';\r\n\r\nimport OneDriveNesting from './OneDriveNesting';\r\nimport { baseConfig } from '../config';\r\nimport Loading from '../hooks/Loading';\r\nimport GetInfo from '../utils/GetInfo';\r\nimport { ArrayBufferToBase64, SearchURL } from '../utils/Func';\r\nimport css from '../assets/css/App.module.css';\r\nimport tokenContext from '../utils/Context';\r\n\r\nfunction Head() {\r\n  const [data, setData] = useState({});\r\n  const [token, setToken] = useState({});\r\n  const [photo, setPhoto] = useState('');\r\n  const [login, setLogin] = useState(true);\r\n  const loginURL = `${baseConfig.loginURL}?client_id=${baseConfig.client_id}&response_type=code&redirect_uri=${baseConfig.redirect_uri}&response_mode=query&scope=${baseConfig.scope}&state=login`;\r\n  const change = useCallback((set, data) => {\r\n    set(data);\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    // 首次登录\r\n    const searchURL = SearchURL(window.location.search);\r\n    if (searchURL.state === 'login') {\r\n      fetch(`/api/login?code=${searchURL.code}&state=${searchURL.state}`)\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          console.log(data);\r\n        });\r\n    }\r\n\r\n    //更新 access_token\r\n    fetch('/api/token', {\r\n      method: 'POST',\r\n      body: JSON.stringify({\r\n        'state': 'getToken'\r\n      })\r\n    })\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        if (data.code !== 200) {\r\n          console.log(data);\r\n          change(setLogin, false);\r\n        } else {\r\n          change(setToken, data.access_token);\r\n        }\r\n      })\r\n  }, [change])\r\n\r\n  useEffect(() => {\r\n    GetInfo('/photo/$value', 'arrayBuffer', token)\r\n      .then(data => {\r\n        change(setPhoto, ArrayBufferToBase64(data));\r\n      })\r\n    GetInfo('/', 'json', token)\r\n      .then(data => {\r\n        change(setData, data);\r\n      })\r\n  }, [token, change])\r\n\r\n  return (\r\n    <tokenContext.Provider value={{ change, token }}>\r\n      <div className={css.App}>\r\n        {\r\n          login\r\n            ?\r\n            data.givenName\r\n              ?\r\n              <BrowserRouter>\r\n                <header>\r\n                  <NavLink to='/'>\r\n                    <img\r\n                      src={`data:image/png;base64,${photo}`}\r\n                      className={css.userPhoto}\r\n                      alt='user'\r\n                    />\r\n                  </NavLink>\r\n                  <NavLink to='/profile'>\r\n                    <p className={css.userName}>{data.givenName}</p>\r\n                  </NavLink>\r\n                  <ul>\r\n                    <NavLink to='/onedrive'>\r\n                      <li className={css.nav}>\r\n                        <i className='iconfont icon-jifangguanli'>OneDrive</i>\r\n                      </li>\r\n                    </NavLink>\r\n                    <NavLink to='/outlook'>\r\n                      <li className={css.nav}>\r\n                        <i className='iconfont icon-185078emailmailstreamline'>OutLook</i>\r\n                      </li>\r\n                    </NavLink>\r\n                    <NavLink to='/article'>\r\n                      <li className={css.nav}>\r\n                        <i className='iconfont icon-article'>Article</i>\r\n                      </li>\r\n                    </NavLink>\r\n                  </ul>\r\n                  {/* <p className={css.logout} onClick={Logout}>LOGOUT</p> */}\r\n                </header >\r\n                <div className={css.page}>\r\n                  <Switch>\r\n                    <Route exact path='/' component={Home}></Route>\r\n                    <Route path='/profile' component={Profile}></Route>\r\n                    <Route path='/onedrive' component={OneDriveNesting}></Route>\r\n                    <Route path='/outlook' component={OutLook}></Route>\r\n                    <Route path='/article' component={Article}></Route>\r\n                  </Switch>\r\n                </div>\r\n              </BrowserRouter>\r\n              :\r\n              <Loading />\r\n            :\r\n            <>\r\n              <p>请点击下方链接登录 ...</p>\r\n              <a href={loginURL}>{loginURL}</a>\r\n            </>\r\n        }\r\n      </div>\r\n    </tokenContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Head;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './assets/css/index.css';\nimport App from './hooks/App';\n// import './utils/Alert';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wall\":\"Iframe_wall__3hzjJ\",\"ifrBox\":\"Iframe_ifrBox__MbDDo\",\"iframe\":\"Iframe_iframe__3Xij1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"trTh\":\"Folder_trTh__3ZRPu\",\"tableA\":\"Folder_tableA__3CAtA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading\":\"Loading_loading__21VZl\",\"maskedAnimation\":\"Loading_maskedAnimation__2VeTB\",\"wall\":\"Loading_wall__3fpwO\",\"FilterAnimation\":\"Loading_FilterAnimation__1P2rA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"nav\":\"OneDrive_nav__d1qUw\"};","const { createProxyMiddleware } = require('http-proxy-middleware');\r\n\r\nmodule.exports = app => {\r\n  app.use(\r\n    '/api',\r\n    createProxyMiddleware({\r\n      target: 'http://emiliatan.online:5173',\r\n      pathRewrite: {\r\n        '^/api': '/'\r\n      },\r\n      changeOrigin: true\r\n    }));\r\n  app.use(\r\n    '/ms',\r\n    createProxyMiddleware({\r\n      target: 'https://graph.microsoft.com/v1.0/me',\r\n      pathRewrite: {\r\n        '^/ms': '/'\r\n      },\r\n      changeOrigin: true\r\n    }));\r\n}"],"sourceRoot":""}