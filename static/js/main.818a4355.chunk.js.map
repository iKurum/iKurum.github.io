{"version":3,"sources":["assets/css/Folder.module.css","assets/css/OneDrive.module.css","assets/css/App.module.css","utils/MicroAPI.js","pages/Home.js","pages/Profile.js","pages/OutLook.js","utils/Context.js","utils/Func.js","hooks/Folder.js","pages/OneDrive.js","hooks/OneDriveNesting.js","hooks/Head.js","utils/Login.js","config.js","hooks/App.js","index.js","assets/css/Head.module.css"],"names":["module","exports","GetInfo","headers","Headers","this","graph","init","token","bearer","append","opt","method","url","c","fetch","then","res","ok","json","Promise","reject","ST","status","statusText","resolve","arrayBuffer","Home","style","height","Profile","OutLook","microContext","createContext","ByteConvert","bytes","isNaN","exp","Math","floor","log","i","pow","toString","length","toFixed","FolderIcon","data","folder","package","type","file","name","split","toLowerCase","Folder","props","pathname","useLocation","className","css","trTh","value","map","v","key","to","tableA","marginRight","size","lastModifiedDateTime","slice","OneDrive","useContext","micro","change","useState","SetData","folderData","SetFolderData","history","useHistory","goto","a","join","push","useEffect","substring","d","catch","err","alert","nav","onClick","fileSystemInfo","infobox","datainfo","createdDateTime","Nesting","path","useRouteMatch","exact","Head","photo","SetPhoto","UserPhoto","useRef","buffer","binary","Uint8Array","len","byteLength","String","fromCharCode","window","btoa","ArrayBufferToBase64","givenName","src","ref","userPhoto","alt","userName","page","component","OneDriveNesting","msalInstance","Msal","auth","clientId","redirectUri","storeAuthStateInCookie","tokenRequest","scopes","Login","console","getAccount","sessionStorage","clear","loginPopup","accessToken","acquireTokenSilent","acquireTokenPopup","timer","clearTimeout","setTimeout","location","reload","GetToken","SetToken","SetMicro","useCallback","set","getToken","t","getItem","g","Provider","app","ReactDOM","render","StrictMode","App","document","getElementById"],"mappings":"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","file":"static/js/main.818a4355.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"trTh\":\"Folder_trTh__3ZRPu\",\"tableA\":\"Folder_tableA__3CAtA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"datainfo\":\"OneDrive_datainfo__32r2b\",\"infobox\":\"OneDrive_infobox__2fgVs\",\"nav\":\"OneDrive_nav__d1qUw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__3J6LF\"};","function GetInfo() {\r\n  const headers = new Headers();\r\n  this.graph = 'https://graph.microsoft.com/v1.0';\r\n\r\n  this.init = token => {\r\n    const bearer = 'Bearer ' + token;\r\n    headers.append('Authorization', bearer);\r\n\r\n    this.opt = {\r\n      method: 'GET',\r\n      headers: headers\r\n    };\r\n\r\n    this.token = token;\r\n  }\r\n\r\n  this.url = (url, c) => {\r\n    switch (c) {\r\n      case 'json':\r\n        return this.token\r\n          ?\r\n          fetch(`${this.graph}${url}`, this.opt)\r\n            .then(res => {\r\n              if (res.ok) {\r\n                return res.json();\r\n              } else {\r\n                return Promise.reject({\r\n                  ST: '获取内容错误 ...',\r\n                  status: res.status,\r\n                  statusText: res.statusText\r\n                })\r\n              };\r\n            })\r\n          :\r\n          Promise.resolve({});\r\n      case 'arrayBuffer':\r\n        return this.token\r\n          ?\r\n          fetch(`${this.graph}${url}`, this.opt)\r\n            .then(res => {\r\n              if (res.ok) {\r\n                return res.arrayBuffer();\r\n              } else {\r\n                return Promise.resolve({\r\n                  ST: '获取内容错误 ...',\r\n                  status: res.status,\r\n                  statusText: res.statusText\r\n                })\r\n              };\r\n            })\r\n          :\r\n          Promise.resolve({});\r\n      default:\r\n        Promise.resolve({});\r\n        break;\r\n    }\r\n  }\r\n}\r\n\r\nexport default GetInfo;","import React from 'react';\r\n\r\nfunction Home() {\r\n  return (\r\n    <>\r\n      Home\r\n      <div style={{ height: '100%' }}>Home</div>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Home;","import React from 'react';\r\n\r\nfunction Profile() {\r\n  return (\r\n    <>\r\n      Profile\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Profile;","import React from 'react';\r\n\r\nfunction OutLook() {\r\n  return (\r\n    <>\r\n      OutLook\r\n    </>\r\n  );\r\n}\r\n\r\nexport default OutLook;","import { createContext } from 'react';\r\n\r\nconst microContext = createContext(null);\r\n\r\nexport default microContext;","function ByteConvert(bytes) {\r\n  if (isNaN(bytes)) {\r\n    return '';\r\n  }\r\n  const symbols = ['bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\n\r\n  let exp = Math.floor(Math.log(bytes) / Math.log(2));\r\n  if (exp < 1) {\r\n    exp = 0;\r\n  }\r\n\r\n  const i = Math.floor(exp / 10);\r\n  bytes = bytes / Math.pow(2, 10 * i);\r\n\r\n  if (bytes.toString().length > bytes.toFixed(2).toString().length) {\r\n    bytes = bytes.toFixed(2);\r\n  }\r\n\r\n  return bytes + ' ' + symbols[i];\r\n};\r\n\r\nfunction ArrayBufferToBase64(buffer) {\r\n  var binary = '';\r\n  var bytes = new Uint8Array(buffer);\r\n  var len = bytes.byteLength;\r\n  for (var i = 0; i < len; i++) {\r\n    binary += String.fromCharCode(bytes[i]);\r\n  }\r\n  return window.btoa(binary);\r\n}\r\n\r\nfunction FolderIcon(data) {\r\n  if (data.folder) {\r\n    return 'iconfont icon-open_filled';\r\n  } else if (data.package && data.package.type === 'oneNote') {\r\n    return 'iconfont icon-microsoftonenote';\r\n  } else if (data.file) {\r\n    switch (data.name.split('.')[data.name.split('.').length - 1].toLowerCase()) {\r\n      case 'pdf':\r\n        return 'iconfont icon-pdf';\r\n      case 'doc':\r\n      case 'docx':\r\n        return 'iconfont icon-Word';\r\n      case 'ppt':\r\n      case 'pptx':\r\n        return 'iconfont icon-office-pptx';\r\n      case 'xls':\r\n      case 'xlsx':\r\n        return 'iconfont icon-office-excel';\r\n      case 'mp4':\r\n      case 'flv':\r\n      case 'mkv':\r\n        return 'iconfont icon-video';\r\n      case 'mp3':\r\n        return 'iconfont icon-MusicAcc';\r\n      case 'jpeg':\r\n      case 'jpg':\r\n      case 'png':\r\n        return 'iconfont icon-image';\r\n      case '7z':\r\n      case 'zip':\r\n      case 'gz':\r\n      case 'rar':\r\n        return 'iconfont icon-filezip';\r\n      case 'md':\r\n        return 'iconfont icon-file-markdown';\r\n      case 'exe':\r\n        return 'iconfont icon-exe';\r\n      case 'iso':\r\n        return 'iconfont icon-iso';\r\n      case 'txt':\r\n        return 'iconfont icon-txt';\r\n      case 'apk':\r\n        return 'iconfont icon-apk';\r\n      default:\r\n        return 'iconfont icon-geshi_weizhi';\r\n    }\r\n  } else {\r\n    return 'iconfont icon-geshi_weizhi';\r\n  }\r\n}\r\n\r\nexport { ByteConvert, ArrayBufferToBase64, FolderIcon };","import React from 'react';\r\nimport { NavLink, useLocation } from 'react-router-dom';\r\nimport { ByteConvert, FolderIcon } from '../utils/Func';\r\nimport css from '../assets/css/Folder.module.css';\r\n\r\nfunction Folder(props) {\r\n  const { pathname } = useLocation();\r\n\r\n  return (\r\n    <table>\r\n      <thead>\r\n        <tr className={css.trTh}>\r\n          <th>名称</th>\r\n          <th>大小</th>\r\n          <th>最后修改时间</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <>\r\n          {\r\n            props.value.map((v, i) => {\r\n              return (\r\n                <tr key={i}>\r\n                  <td>\r\n                    {\r\n                      v.folder\r\n                        ?\r\n                        <NavLink to={`${pathname}/${v.name}`}>\r\n                          <p className={css.tableA}>\r\n                            <i className={FolderIcon(v)} style={{ marginRight: '10px' }}></i>\r\n                            {v.name}\r\n                          </p>\r\n                        </NavLink>\r\n                        :\r\n                        <p className={css.tableA}>\r\n                          <i className={FolderIcon(v)} style={{ marginRight: '10px' }}></i>\r\n                          {v.name}\r\n                        </p>\r\n                    }\r\n                  </td>\r\n                  <td>{ByteConvert(v.size)}</td>\r\n                  <td>{v.lastModifiedDateTime.slice(0, 10)}</td>\r\n                  {\r\n                    v.folder ? null : <td><i className='iconfont icon-xiazai'></i></td>\r\n                  }\r\n                </tr>\r\n              );\r\n            })\r\n          }\r\n        </>\r\n      </tbody>\r\n    </table>\r\n  );\r\n}\r\n\r\nexport default Folder;","import React, { useContext, useEffect, useState } from 'react';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\nimport microContext from '../utils/Context';\r\nimport { ByteConvert } from '../utils/Func';\r\nimport Folder from '../hooks/Folder';\r\nimport css from '../assets/css/OneDrive.module.css';\r\n\r\nfunction OneDrive() {\r\n  const { micro, change } = useContext(microContext);\r\n  const [data, SetData] = useState({});\r\n  const [folderData, SetFolderData] = useState([]);\r\n  const { pathname } = useLocation();\r\n  const history = useHistory();\r\n\r\n  function goto(i) {\r\n    return () => {\r\n      const a = '/' + pathname.split('/').slice(1, pathname.split('/').length).slice(0, i).join('/');\r\n      history.push(a);\r\n    };\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (micro.url) {\r\n      micro.url(`/me/drive/root${!!pathname.substring(9) ? `:${pathname.substring(9)}` : ''}`, 'json')\r\n        .then(d => {\r\n          change(SetData, d);\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        });\r\n\r\n      micro.url(`/me/drive/root${!!pathname.substring(9) ? `:${pathname.substring(9)}:` : ''}/children`, 'json')\r\n        .then(d => {\r\n          change(SetFolderData, d.value);\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        });\r\n    }\r\n  }, [micro, change, pathname])\r\n\r\n  return (\r\n    <>\r\n      <p className={css.nav}>\r\n        {\r\n          pathname.split('/').map((v, i) => {\r\n            if (i) {\r\n              return <span key={i} onClick={goto(i)}>{v === 'onedrive' ? '/' : v}</span>\r\n            }\r\n            return null;\r\n          })\r\n        }\r\n      </p>\r\n      {\r\n        data.fileSystemInfo\r\n          ?\r\n          <div className={css.infobox}>\r\n            <p className={css.datainfo}>\r\n              <span>\r\n                创建时间：\r\n                {data.fileSystemInfo.createdDateTime.slice(0, 10)}\r\n              </span>\r\n              <span>\r\n                上次修改时间：\r\n                {data.fileSystemInfo.lastModifiedDateTime.slice(0, 10)}\r\n              </span>\r\n              <span>\r\n                已使用空间：\r\n                {ByteConvert(data.size)}\r\n              </span>\r\n            </p>\r\n            <hr />\r\n          </div>\r\n          :\r\n          <>加载中 ...</>\r\n      }\r\n      {\r\n        folderData.length > 0\r\n          ?\r\n          <Folder value={folderData} />\r\n          :\r\n          <>加载中 ...</>\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default OneDrive;","import React from 'react';\r\nimport { Switch, Route, useRouteMatch } from 'react-router-dom';\r\nimport OneDrive from '../pages/OneDrive';\r\n\r\nfunction Nesting() {\r\n  const { path } = useRouteMatch();\r\n\r\n  return (\r\n    <Switch>\r\n      <Route exact path={path}>\r\n        <OneDrive />\r\n      </Route>\r\n      <Route path={`${path}/:folder`}>\r\n        <OneDrive />\r\n      </Route>\r\n    </Switch>\r\n  );\r\n}\r\n\r\nexport default Nesting;","import React, { useState, useContext, useEffect, useRef } from 'react';\r\nimport { BrowserRouter, Route, NavLink, Switch } from 'react-router-dom';\r\nimport Home from '../pages/Home';\r\nimport Profile from '../pages/Profile';\r\nimport OutLook from '../pages/OutLook';\r\nimport OneDriveNesting from './OneDriveNesting';\r\nimport microContext from '../utils/Context';\r\nimport { ArrayBufferToBase64 } from '../utils/Func';\r\nimport css from '../assets/css/Head.module.css';\r\n\r\nfunction Head() {\r\n  const [data, SetData] = useState({});\r\n  const [photo, SetPhoto] = useState('');\r\n  const { micro, change } = useContext(microContext);\r\n  const UserPhoto = useRef(null)\r\n\r\n  useEffect(() => {\r\n    if (micro.url) {\r\n      micro.url('/me?$select=givenName', 'json')\r\n        .then(d => {\r\n          change(SetData, d);\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        });\r\n      micro.url('/me/photo/$value', 'arrayBuffer')\r\n        .then(d => {\r\n          change(SetPhoto, ArrayBufferToBase64(d));\r\n        })\r\n        .catch(err => {\r\n          alert(err);\r\n        });\r\n    }\r\n  }, [micro, change])\r\n\r\n  return (\r\n    <>\r\n      {\r\n        data.givenName\r\n          ?\r\n          <BrowserRouter>\r\n            <header>\r\n              <NavLink to='/'>\r\n                <img\r\n                  src={`data:image/png;base64,${photo}`}\r\n                  ref={UserPhoto}\r\n                  className={css.userPhoto}\r\n                  alt='user'\r\n                />\r\n              </NavLink>\r\n              <NavLink to='/profile'>\r\n                <p className={css.userName}>{data.givenName}</p>\r\n              </NavLink>\r\n              <ul>\r\n                <NavLink to='/onedrive'>\r\n                  <li className={css.nav}>\r\n                    <i className='iconfont icon-jifangguanli'>OneDrive</i>\r\n                  </li>\r\n                </NavLink>\r\n                <NavLink to='/outlook'>\r\n                  <li className={css.nav}>\r\n                    <i className='iconfont icon-185078emailmailstreamline'>OutLook</i>\r\n                  </li>\r\n                </NavLink>\r\n              </ul>\r\n            </header >\r\n            <div className={css.page}>\r\n              <Switch>\r\n                <Route exact path='/' component={Home}></Route>\r\n                <Route path='/profile' component={Profile}></Route>\r\n                <Route path='/onedrive' component={OneDriveNesting}></Route>\r\n                <Route path='/outlook' component={OutLook}></Route>\r\n              </Switch>\r\n            </div>\r\n          </BrowserRouter>\r\n          :\r\n          <>加载中 ...</>\r\n      }\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Head;","import * as Msal from \"msal\";\r\nimport { config } from '../config';\r\n\r\nconst msalInstance = new Msal.UserAgentApplication(config.msal);\r\nconst tokenRequest = {\r\n  scopes: [\"user.read\"]\r\n};\r\n\r\nexport function Login() {\r\n  console.log('login ...');\r\n  if (msalInstance.getAccount()) {\r\n    return accessToken();\r\n  } else {\r\n    return init();\r\n  }\r\n}\r\n\r\nfunction init() {\r\n  console.log('初始化 ...');\r\n  sessionStorage.clear();\r\n  msalInstance.loginPopup()\r\n    .catch(err => {\r\n      alert(err);\r\n    });\r\n  return accessToken();\r\n}\r\n\r\nfunction accessToken() {\r\n  console.log('Token:');\r\n  if (msalInstance.getAccount()) {\r\n    console.log('尝试获取 Token 1 ...');\r\n    return msalInstance.acquireTokenSilent(tokenRequest)\r\n      .then(res => {\r\n        console.log('尝试获取 Token 1 ...ok');\r\n        return res.accessToken;\r\n      })\r\n      .catch(err => {\r\n        console.log('尝试获取 Token 2 ...');\r\n        if (err.name === \"InteractionRequiredAuthError\") {\r\n          return msalInstance.acquireTokenPopup(tokenRequest)\r\n            .then(res => {\r\n              console.log('尝试获取 Token 2 ...ok');\r\n              return res.accessToken;\r\n            })\r\n            .catch(err => {\r\n              console.log('获取失败 Token ...');\r\n              console.log(err);\r\n            });\r\n        }\r\n      })\r\n  } else {\r\n    console.log('尝试刷新 ...')\r\n    console.log('reload ... 1s');\r\n    let timer = null;\r\n    clearTimeout(timer);\r\n    timer = setTimeout(() => {\r\n      console.log('reload ...');\r\n      window.location.reload()\r\n    }, 1000);\r\n    return new Promise(() => '', () => '');\r\n  }\r\n}","export const config = {\r\n  msal: {\r\n    auth: {\r\n      clientId: '2c16b16f-0bb3-41ed-a423-3ae5dfae9b63',\r\n      redirectUri: \"http://localhost:3000/\",\r\n      storeAuthStateInCookie: true\r\n    }\r\n  }\r\n}\r\n","import React, { useEffect, useState, useCallback } from 'react';\r\nimport GetInfo from '../utils/MicroAPI';\r\nimport Head from './Head';\r\nimport microContext from '../utils/Context';\r\nimport { Login } from '../utils/Login';\r\nimport css from '../assets/css/App.module.css';\r\n\r\nfunction GetToken() {\r\n  const [token, SetToken] = useState('');\r\n  const [micro, SetMicro] = useState('');\r\n\r\n  const change = useCallback((set, data) => {\r\n    set(data);\r\n  }, [])\r\n\r\n  const getToken = useCallback(() => {\r\n    Login().then(t => {\r\n      console.log('写入 Token ...');\r\n      change(SetToken, t);\r\n    }).catch(err => {\r\n      console.log(err);\r\n    });\r\n  }, [change])\r\n\r\n  useEffect(() => {\r\n    if (sessionStorage.getItem('msal.idtoken')) {\r\n      getToken();\r\n    } else {\r\n      Login()\r\n        .then(d => {\r\n          console.log(d);\r\n        })\r\n        .catch(err => {\r\n          console.log(err);\r\n        });\r\n    }\r\n  }, [getToken])\r\n\r\n  useEffect(() => {\r\n    const g = new GetInfo();\r\n    if (token) {\r\n      g.init(token);\r\n    }\r\n    change(SetMicro, g);\r\n  }, [change, token])\r\n\r\n  return (\r\n    <microContext.Provider value={{\r\n      micro,\r\n      change\r\n    }}>\r\n      <div className={css.app}>\r\n        <Head />\r\n      </div>\r\n    </microContext.Provider>\r\n  );\r\n}\r\n\r\nexport default GetToken;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './assets/css/index.css';\nimport App from './hooks/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"Head_page__kWlT5\",\"userPhoto\":\"Head_userPhoto__3cBOH\",\"userName\":\"Head_userName__UpgrF\",\"nav\":\"Head_nav__RgzWw\"};"],"sourceRoot":""}